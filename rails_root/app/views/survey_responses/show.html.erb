<p style="color: green"><%= notice %></p>

<%# FIXME: Move this to a stylesheet when we have time %>
<style>
  .section-header {
    cursor: pointer;
    user-select: none;
  }

  .section-header h4:before {
    content: '\25B6';
    font-size: .85em;
    min-width: 1.5rem;
  }

  .section-header[aria-expanded="true"] h4:before {
    content: '\25BC';
    font-size: .85em;
    min-width: 1.5rem;
  }

  tr {
    transition: height 0.0s ease;
  }

  tr.collapsing {
    height: auto;
    transition: height 0.0s ease;
  }
</style>

<div class="container-lg">
  <h1 class="text-center">Your leadership type is: (tbd)</h1>
  <div class="row d-flex justify-content-center">
    <%= image_tag("https://upload.wikimedia.org/wikipedia/commons/7/70/Tetrahedron.gif", style: "width:400px;" ) %>
  </div>
  <div class="row d-flex justify-content-center">
    <div class="col-8">
      <h3>
        This tetrahedron represents the alignment of the four factors based on your leadership behaviors to align the four factors.
      </h3>
      <p style="text-align:justify;">
        The purpose of this qualitative study was to apply the Synergistic Leadership Theory (SLT) to the leadership experiences of five female superintendents leading successful school districts. The SLT is an interactive theory, which includes female experiences, but it applies to men and women. It provides a framework for leaders to align four factors that impact successful leadership: (a) attitudes, values, and beliefs; (b) leadership behaviors; (c) organizational structure; and (d) external forces. Four research questions guided my study: (a) What are the leadership behaviors of the superintendents? (b) Is the organizational structure of each district aligned with the superintendentâ€™s leadership behaviors? (c) How do the leadership behaviors of the superintendent impact the relations between the district and the external forces? (d) Are the attitudes, values, and beliefs of the superintendent aligned to the attitudes, values, and beliefs of the school board member and the administrative team member
      </p>
    </div>
  </div>
  <hr>
  <% choices = ["Strongly Disagree", "Disagree", "Agree", "Strongly Agree"] %>
  <div class="row d-flex justify-content-center">
    <% sections = @survey_response.questions.map(&:section).uniq %>
    <% answers = sections.map {|section| [section, @survey_response.answers.select {|ans| ans.question.section == section}]}.to_h%>
    <div class="col-9">
      <h2 class="text-center">Your Responses</h2>
      <br>
      <% sections.each do |section| %>
        <% collapse_id = "section#{section}"%>
        <div class="section-header"
             data-bs-toggle="collapse"
             data-bs-target="#<%= collapse_id %>"
             aria-expanded="false"
             aria-controls="<%= collapse_id %>">
          <div class="row d-flex justify-content-center">
            <h4 class="text-center col-8">
              <%= @sections[section][:title] %>
            </h4>
          </div>
          <div class="row d-flex justify-content-center">
            <div class="col-8">
              <p class="text-center"><%= @sections[section][:prompt] %></p>
            </div>
          </div>
        </div>
        <div class="collapse" id="<%= collapse_id %>">
          <table class="table">
            <thead class="bg-aggie-maroon text-gray-100">
              <tr>
                <th>Question</th>
                <th>Response</th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
              </tr>
            </thead>
            <% answers[section].each do |ans| %>
              <% question_collapse_id = "question#{ans.question.id}" %>
              <tr
                data-bs-toggle="collapse"
                data-bs-target="#<%= question_collapse_id %>"
                aria-expanded="false"
                aria-controls="<%= question_collapse_id %>"
              >
                <td><%= ans.question.text %></td>
                <td><%= choices[ans.choice] %></td>
                <% 4.times do |i| %>
                <td>
                  <input
                    type="radio"
                    disabled="disabled"
                    <%= 'checked="checked"' if i == ans.choice %>
                  >
                </td>
                <% end %>
              </tr>
              <tr class="collapse" id="<%= question_collapse_id %>">
                <td colspan="6">
                    <%= ans.question.explanation %>
                </td>
              </tr>
            <% end %>
          </table>
        </div>
      <% end %>
    </div>
  </div>
  <hr>
  <div class="row d-flex justify-content-center">
    <div class="col-8 btn-group" role="group">
      <%= link_to "Edit Response",
            edit_survey_response_path(@survey_response),
            class: "btn btn-outline-primary"
      %>
      <%= button_to "Create Invitation",
            invitations_path(survey_response_share_code: @survey_response.share_code),
            method: :post,
            id: "invitation-button",
            form_class: "btn btn-outline-success",
            class: "btn-passthrough"
      %>
      <%= link_to "Delete Response",
            @survey_response,
            method: :delete,
            class: "btn btn-outline-danger"
      %>
    </div>
  </div>
  <br>
  <div class="row d-flex justify-content-center">
    <div class="col-6 text-center">
      <%= link_to "Back to survey responses", survey_responses_path %>
    <div>
  </div>
</div>